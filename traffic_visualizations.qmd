---
title: "Traffic Visualizations"
format: html
---

```{r}
library(tidyverse)

# loading in traffic data: 
traffic_raw <- read_csv("hw03-data/Traffic Data/Lekagul Sensor Data.csv")
```

```{r}
library(dplyr)

# change column names into better formats
traffic_clean <- traffic_raw |>
  rename(timestamp = Timestamp,
         car_id = `car-id`,
         car_type = `car-type`,
         gate_name = `gate-name`)

```

```{r}
# Define a named list of coordinates
coordinates_list <- list(
  "camping0" = c(52, 41),
  "camping1" = c(129, 50),
  "camping2" = c(44, 64),
  "camping3" = c(45, 68),
  "camping4" = c(48, 89),
  "camping5" = c(20, 121),
  "camping6" = c(150, 177),
  "camping7" = c(181, 145),
  "camping8" = c(183, 48),
  "entrance0" = c(62, 13),
  "entrance1" = c(17, 67),
  "entrance2" = c(183, 87),
  "entrance3" = c(115, 167),
  "entrance4" = c(140, 184),
  "gate0" = c(63, 33),
  "gate1" = c(58, 44),
  "gate2" = c(24, 54),
  "gate3" = c(149, 60),
  "gate4" = c(164, 114),
  "gate5" = c(131, 146),
  "gate6" = c(116, 151),
  "gate7" = c(87, 160),
  "gate8" = c(138, 181),
  "general-gate0" = c(110, 9),
  "general-gate1" = c(64, 25),
  "general-gate2" = c(104, 32),
  "general-gate4" = c(69, 98),
  "general-gate5" = c(124, 111),
  "general-gate6" = c(136, 137),
  "general-gate7" = c(65, 144),
  "ranger-base" = c(128, 175),
  "ranger-stop0" = c(89, 16),
  "ranger-stop1" = c(19, 24),
  "ranger-stop2" = c(80, 35),
  "ranger-stop3" = c(148, 45),
  "ranger-stop4" = c(18, 95),
  "ranger-stop5" = c(151, 118),
  "ranger-stop6" = c(123, 147),
  "ranger-stop7" = c(100,152)
)

# Assign coordinates to the traffic dataset using mutate
traffic_clean <- traffic_clean |>
  mutate(
    coordinates = map(gate_name, ~ coordinates_list[[.x]])
  )
```


```{r}
# checking if coordinates are all assigned, compared to the raw data
check <- traffic_clean |>
  group_by(gate_name, coordinates) |>
  summarise(n = n())
check_raw <- traffic_raw |>
  group_by(`gate-name`) |>
  summarise(n = n())

# check if there are missing gates that are not assigned with an coordinate
missing_coords <- traffic_clean %>%
  filter(is.null(coordinates)) %>%
  select(gate_name)

if (nrow(missing_coords) > 0) {
  warning("The following gate names do not have corresponding coordinates:")
  print(missing_coords)
}
```

```{r}
# break the coordinates into x and y, later used to create visualizations
traffic_clean <- traffic_clean |> 
  mutate(
    x = map_dbl(coordinates, ~ ifelse(length(.x) == 2, .x[1], NA)),  # Assign first element as x
    y = map_dbl(coordinates, ~ ifelse(length(.x) == 2, .x[2], NA))   # Assign second element as y
  )
```

```{r}
library(ggplot2)

ggplot(data = traffic_clean, aes(x = ))
```

```{r}
library(tidyverse)

# Step 1: Create a data frame for gates and their coordinates
gates_data <- data.frame(
  gate_name = c("camping0", "camping1", "camping2", "camping3", "camping4",
                "camping5", "camping6", "camping7", "camping8", "entrance0",
                "entrance1", "entrance2", "entrance3", "entrance4", "gate0",
                "gate1", "gate2", "gate3", "gate4", "gate5", "gate6",
                "gate7", "gate8", "general-gate0", "general-gate1",
                "general-gate2", "general-gate4", "general-gate5",
                "general-gate6", "general-gate7", "ranger-base", 
                "ranger-stop0", "ranger-stop1", "ranger-stop2", 
                "ranger-stop3", "ranger-stop4", "ranger-stop5", 
                "ranger-stop6", "ranger-stop7"),
  x = c(52, 129, 44, 45, 48, 20, 150, 181, 183, 62, 
        17, 183, 115, 140, 63, 58, 24, 149, 164, 131, 
        116, 87, 138, 110, 64, 104, 69, 124, 136, 65, 
        128, 89, 19, 80, 148, 18, 151, 123, 100),
  y = c(41, 50, 64, 68, 89, 121, 177, 145, 48, 13, 
        67, 87, 167, 184, 33, 44, 54, 60, 114, 146, 
        151, 160, 181, 9, 25, 32, 98, 111, 137, 144, 
        175, 16, 24, 35, 45, 95, 118, 147, 152)
)

# Step 2: Create the gate map using ggplot2
ggplot(gates_data, aes(x = x, y = y, label = gate_name)) +
  geom_point(color = "blue", size = 3) +  # Points for each gate
  geom_text(vjust = -1, hjust = 0.5) +  # Add text labels for the gates
  labs(title = "Map of Gates",
       x = "X Coordinate",
       y = "Y Coordinate") +
  theme_minimal() + # Use a minimal theme for a clean look
  scale_y_reverse()  # Reverse the y-axis

```

